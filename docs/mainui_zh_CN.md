# 导入时刻表数据使用说明
  
### 基本步骤
  
1.  **选择根目录文件夹**
    *   此文件夹用于存放所有时刻表数据及系统数据。
  
2.  **选择游戏存档文件**
    *   存档文件路径通常为：
        `C:\Program Files (x86)\Steam\userdata\XXXX\1066780\local\save\xxx.lua`
        （具体路径取决于您的 Steam 安装位置）。
    >   **提示**：也可在游戏中通过 **设置 → 高级 → 打开用户数据文件夹** 来定位。
  
3.  **进入游戏，获取存档信息**
    *   请按照 **“站点、线路数据录入”** 内的说明，获取存档的站点和线路信息。
    *   成功导入后，会生成 `存档名_station.xlsx` 和 `存档名_line.xlsx` 两个文件。
    *   请根据需要核对并修改上述文件中的数据。_line文件与**覆盖选项**有关请注意更改。
  
### 数据录入模式说明
  
#### 简单模式
*   **运行逻辑**：程序将根据 `_line.xlsx` 文件中的线路数据，自动寻找对应的时刻表文件。
*   **文件命名规则**：`线路名.xlsx`，或 `线路名_序号.xlsx`（例如：`Z1.xlsx`， `Z1_2.xlsx`）。
    *   同一线路的不同时刻表请按此规则连续命名。
    *   注意，首个文件请不要添加_1，编号从_2开始。
*   **表单处理**：自动采用文件内的 **所有表单**。
  
#### 列表模式
*   程序会自动生成 `存档名_list.xlsx` 文件。
    *   **第一行**：可随意更改（通常为标题或说明）。
    *   **第二行及以后**：每一行代表一条线路的导入配置。
    *   **第一列**：线路名称。
    *   **第二列开始**：每两列为一组，分别代表 **文件名** 和 **表单名**。
*   **多表单**：如需指定多个表单，请用 **空格** 分隔其名称。
*   **全部表单**：如需采用文件内所有表单，请将表单名留空。
*   可无限向右添加配置列，也可为同一线路另起一行配置。
  
### 覆盖选项说明
  

| 选项 | 说明 |
| :--- | :--- |
| **仅覆盖** | 仅覆盖检测到的现有时刻表（例如，若数据中只有一个车次的时刻表，则只覆盖该车次）。 |
| **清空line后导入** | 检测 `_line.xlsx` 中列出的所有线路，先删除这些线路的现有时刻表（如果存在），再导入新数据。**适用于**：当存档中存在非火车线路的时刻表时，可设置 `_line.xlsx` 只包含火车线路，从而仅清空并覆盖火车时刻表。 |
| **全部清空后导入** | 删除存档中 **所有** 现有的时刻表，然后导入新数据。 |

  
### 其他选项说明
  

| 选项 | 说明 |
| :--- | :--- |
| **xlsx, csv** | 选择导入文件的格式。**注意**：`csv` 仅支持 UTF-8 编码（请在另存为界面选择），且在列表模式下会忽略表单名。 |
| **忽略最后一行数据** | 勾选后，程序将忽略数据表的最后一行。 |
| **时刻表堆叠** | **举例**：若一班车在 60 分钟内跑了 3 个相同的交路，开启此选项将记录 3 组时刻表，关闭则只记录 1 组。 |
  

## 注意事项与格式要求
  
1.  **时刻表格式**：
    *   必须保证 Excel 文件的 **第二列** 为站点名称，**第三、四列** 分别为到站、发车时刻。
    *   程序仅读取这三列数据，其余列不影响导入。

2.  **名称匹配**：
    *   请确保时刻表中的 **站点名** 和 **线路名**，与游戏存档中的数据 **完全匹配**（仅允许前后相差有空格）。

3.  **重复数据处理**：
    *   如果检测到完全重复的时刻表数据，或两组数据的到/发车时间间隔小于 5 秒，程序会 **自动合并** 这些重复项，并在导入前给出提示。

4.  **备份与安全**：
    *   每次导入都会自动为上一次的数据创建一个备份，存放在存档文件夹内。
    *   **回档方法**：找到备份文件，修改其文件名（移除备份标记），然后复制回存档文件夹覆盖即可。（操作前请在系统文件夹选项中开启“文件扩展名”显示）。

5.  **重要操作前提**：
    *   **导入时刻表时，请务必关闭游戏或确保存档未处于加载状态。**

  


如果您在使用过程中遇到任何问题，请通过软件内的 **“关于”界面** 与我联系。  
B站私信 、 GitHub Issues 或者邮箱均可。
   
谢谢使用！